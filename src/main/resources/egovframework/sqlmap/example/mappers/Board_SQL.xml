<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- 마이바티스 버전 -->

<mapper namespace="egovframework.example.sample.service.impl.BoardMapper">

	<select id="SelectBoardList" resultType="boardVO">
		SELECT
		 	    board_no
			   ,board_title
			   ,board_writer
			   ,board_hit
			   ,board_date
			   ,board_cont
		  FROM  tb_board 
		  <where>
 			<if test="(searchText != null) and (!searchText.equals(''))">
				<choose>
                    <when test="selectSearch eq 'title'.toString()">
                        and board_title Like CONCAT('%', #{searchText}, '%')
                    </when>
                    <when test="selectSearch eq 'content'.toString()">
                        and board_cont Like CONCAT('%', #{searchText}, '%')
                    </when>
                    <when test="selectSearch eq 'writer'.toString()">
                        and board_writer Like CONCAT('%', #{searchText}, '%')
                    </when>
                    <otherwise>
                    	and (    board_title Like CONCAT('%', #{searchText}, '%')
						      or board_cont LIKE CONCAT('%', #{searchText}, '%')
						      or board_writer LIKE CONCAT('%', #{searchText}, '%')
						       )
                    </otherwise>
		        </choose>
	         </if>
           </where>	
		  
	  ORDER BY  board_no desc
		 LIMIT  #{pageSize}
		OFFSET  #{pageindex} 
		
 	</select>
	
	<select id="countList" resultType="int">
		SELECT  count(*)
		  FROM  tb_board
		  <where>
 			<if test="(searchText != null) and (!searchText.equals(''))">
				<choose>
                    <when test="selectSearch eq 'title'.toString()">
                        and board_title Like CONCAT('%', #{searchText}, '%')
                    </when>
                    <when test="selectSearch eq 'content'.toString()">
                        and board_cont Like CONCAT('%', #{searchText}, '%')
                    </when>
                    <when test="selectSearch eq 'writer'.toString()">
                        and board_writer Like CONCAT('%', #{searchText}, '%')
                    </when>
                    <otherwise>
                    	and (    board_title Like CONCAT('%', #{searchText}, '%')
						      or board_cont LIKE CONCAT('%', #{searchText}, '%')
						      or board_writer LIKE CONCAT('%', #{searchText}, '%')
						       )
                    </otherwise>
		        </choose>
	         </if>
           </where>	
	</select>
	
	
	<select id="boardSelectOne" resultType="boardVO">
		SELECT
		 	    board_no
			   ,board_title
			   ,board_writer
			   ,board_hit
			   ,board_date
			   ,board_cont
		  FROM  tb_board 
		 WHERE  board_no = #{board_no}
	</select>
	
	<update id="boardHitUp" >
		UPDATE  tb_board
		   SET  board_hit = board_hit +1
		 WHERE  board_no = #{board_no}
	
	</update>
</mapper>